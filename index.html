<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéØ Probability Master ‚Äì Stage 5 Challenge</title>
<style>
body {
  margin:0;
  font-family:"Segoe UI",sans-serif;
  background:linear-gradient(135deg,#240b36,#c31432);
  color:#fff;
  min-height:100vh;
  display:flex;
  overflow:hidden;
}
.sidebar {
  width:220px;
  background:rgba(0,0,0,0.3);
  padding:16px;
  border-right:1px solid rgba(255,255,255,0.2);
}
.tab {
  width:100%;
  margin:8px 0;
  padding:10px;
  border:none;
  border-radius:8px;
  background:rgba(255,255,255,0.15);
  color:#fff;
  cursor:pointer;
  transition:0.2s;
}
.tab:hover {background:rgba(255,255,255,0.3);}
.main {
  flex:1;
  display:flex;
  flex-direction:column;
  padding:16px;
}
.topbar {
  display:flex;
  justify-content:space-between;
  background:rgba(255,255,255,0.1);
  padding:10px;
  border-radius:10px;
  margin-bottom:10px;
}
.badge {
  background:rgba(255,255,255,0.15);
  padding:6px 10px;
  border-radius:10px;
}
.question {
  text-align:center;
  font-weight:bold;
  font-size:1.3em;
  margin:10px auto;
}
#gameArea {
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background:rgba(255,255,255,0.1);
  border-radius:14px;
  border:2px solid rgba(255,255,255,0.3);
  padding:20px;
}
.choice {
  background:linear-gradient(45deg,#ff416c,#ff4b2b);
  color:#fff;
  font-weight:bold;
  margin:8px;
  padding:10px 20px;
  border-radius:10px;
  cursor:pointer;
  transition:0.3s;
  width:80%;
  max-width:420px;
  text-align:center;
}
.choice:hover {transform:scale(1.05); background:linear-gradient(45deg,#ff4b2b,#ff416c);}
.correct {background:#4caf50 !important;}
.incorrect {background:#e53935 !important;}
#message {
  text-align:center;
  margin-top:10px;
  font-weight:bold;
  font-size:1.1em;
  transition:0.3s;
}

/* Fireworks */
canvas#fireworks {
  position:fixed;
  left:0; top:0;
  width:100%; height:100%;
  pointer-events:none;
}
</style>
</head>
<body>

<aside class="sidebar">
<h2>üéØ Probability</h2>
<button class="tab" id="restartTab">Restart</button>
<button class="tab" id="hintTab">Hint</button>
<button class="tab" id="stopTab">Stop</button>
<button class="tab" id="helpTab">Help</button>
</aside>

<main class="main">
  <div class="topbar">
    <div class="badge">Score: <span id="score">0</span></div>
    <div class="badge">Round: <span id="round">0</span>/15</div>
  </div>
  <div class="question" id="question">Press Restart to begin!</div>
  <div id="gameArea"></div>
  <div id="message"></div>
</main>

<canvas id="fireworks"></canvas>
<audio id="cheer" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_6a692fd845.mp3?filename=applause-44774.mp3"></audio>

<script>
(() => {
const $ = id => document.getElementById(id);
let score = 0, round = 0, active = false;
let current = null; // ‚úÖ make current question global
const maxRounds = 15;

const cheers = ["üéÜ Fantastic!", "üéâ Amazing work!", "üî• You‚Äôre unstoppable!", "üåü Great reasoning!", "üëè Excellent probability logic!"];

const questions = [
  {q:"Two coins are tossed. What is the probability of getting exactly one head?", choices:["1/2","1/4","2/3","3/4"], a:"1/2", hint:"There are 4 outcomes: HH, HT, TH, TT."},
  {q:"A die is rolled twice. What is the total number of possible outcomes?", choices:["36","12","18","24"], a:"36", hint:"6 √ó 6 outcomes."},
  {q:"Event A and B are independent. If P(A)=0.4, P(B)=0.5, then P(A and B)=?", choices:["0.2","0.9","0.1","0.25"], a:"0.2", hint:"Multiply: 0.4 √ó 0.5."},
  {q:"From a deck of 52 cards, P(getting a heart)=", choices:["1/4","1/13","1/2","1/26"], a:"1/4", hint:"There are 4 suits of equal size."},
  {q:"If P(A)=0.7 and P(B)=0.5 and A, B are independent, find P(A or B).", choices:["0.85","1.2","0.35","0.65"], a:"0.85", hint:"Use formula: P(A)+P(B)-P(A‚à©B)."},
  {q:"A spinner has 5 equal regions. Probability of NOT landing on red if 2 are red?", choices:["3/5","2/5","1/2","4/5"], a:"3/5", hint:"P(not red)=1‚àíP(red)."},
  {q:"Two dice are rolled. Probability that sum = 7?", choices:["1/6","1/12","1/36","1/3"], a:"1/6", hint:"Favourable pairs: (1,6),(2,5),(3,4),(4,3),(5,2),(6,1)."},
  {q:"In a Venn diagram, events A and B overlap. What does the overlap represent?", choices:["A‚à™B","A‚à©B","A'","B'"], a:"A‚à©B", hint:"Intersection = both events occur."},
  {q:"A bag has 4 red, 3 blue. One ball is drawn, not replaced, then another. Are these events independent?", choices:["No","Yes"], a:"No", hint:"Without replacement affects probability."},
  {q:"If P(A)=0.3, P(B)=0.4, and P(A‚à©B)=0.1, find P(A‚à™B).", choices:["0.6","0.7","0.5","0.3"], a:"0.6", hint:"Add and subtract overlap: 0.3+0.4‚àí0.1."},
  {q:"If P(A)=0.5, what is P(not A)?", choices:["0.5","0.2","0.3","0.8"], a:"0.5", hint:"1‚àí0.5."},
  {q:"You roll a die twice. Probability of getting at least one 6?", choices:["11/36","1/6","25/36","5/6"], a:"11/36", hint:"1 - P(no 6 in both rolls)."},
  {q:"A bag has 6 marbles numbered 1‚Äì6. Probability of even number?", choices:["1/2","1/3","2/3","1/6"], a:"1/2", hint:"Even numbers: 2,4,6."},
  {q:"If P(A|B)=0.3 and P(B)=0.5, find P(A and B).", choices:["0.15","0.8","0.2","0.3"], a:"0.15", hint:"Multiply: P(A|B) √ó P(B)."},
  {q:"A probability of 0.25 means the event is...", choices:["Unlikely","Likely","Certain","Impossible"], a:"Unlikely", hint:"Less than 0.5 means less likely to occur."}
];

// üéá Fireworks
const canvas = $("fireworks");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let particles = [];

function createFirework(x, y){
  for(let i=0;i<80;i++){
    particles.push({
      x, y,
      radius:Math.random()*3+1,
      color:`hsl(${Math.random()*360},100%,60%)`,
      speedX:(Math.random()-0.5)*8,
      speedY:(Math.random()-1)*8,
      alpha:1
    });
  }
}
function animateFireworks(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach((p,i)=>{
    ctx.globalAlpha=p.alpha;
    ctx.fillStyle=p.color;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
    ctx.fill();
    p.x+=p.speedX;
    p.y+=p.speedY;
    p.alpha-=0.02;
    if(p.alpha<=0) particles.splice(i,1);
  });
  requestAnimationFrame(animateFireworks);
}
animateFireworks();

function playCheer(){
  const cheer=$("cheer");
  cheer.currentTime=0;
  cheer.play();
}

function startRound(){
  if(round >= maxRounds){ endGame(); return; }
  active = true;
  $("message").textContent = "";
  $("gameArea").innerHTML = "";
  round++;
  $("round").textContent = round;
  current = questions[Math.floor(Math.random()*questions.length)]; // ‚úÖ assign globally
  $("question").textContent = current.q;
  const shuffled = [...current.choices].sort(() => Math.random() - 0.5);
  shuffled.forEach(choice => {
    const btn = document.createElement("div");
    btn.className = "choice";
    btn.textContent = choice;
    btn.onclick = e => {
      if(!active) return;
      if(choice === current.a){
        btn.classList.add("correct");
        score++;
        $("score").textContent = score;
        $("message").textContent = cheers[Math.floor(Math.random()*cheers.length)];
        $("message").style.color = "#4ef04e";
        createFirework(e.clientX, e.clientY);
        playCheer();
      } else {
        btn.classList.add("incorrect");
        $("message").textContent = `‚ùå Wrong! Correct: ${current.a}`;
        $("message").style.color = "#ff6060";
      }
      active = false;
      setTimeout(startRound, 1600);
    };
    $("gameArea").appendChild(btn);
  });
}

function endGame(){
  $("question").textContent = `üèÅ Game over! Final Score: ${score}/${round}`;
  $("gameArea").innerHTML = "";
  $("message").textContent = "Press Restart to play again.";
  active = false;
}

$("restartTab").onclick = () => {
  score = 0; round = 0;
  $("score").textContent = 0;
  $("round").textContent = 0;
  $("question").textContent = "Starting...";
  setTimeout(startRound, 800);
};

// ‚úÖ Fixed Hint function
$("hintTab").onclick = () => { 
  if(current && current.hint) alert("üí° Hint: " + current.hint); 
  else alert("No hint available yet! Start a round first.");
};

$("stopTab").onclick = () => { 
  $("gameArea").innerHTML = ""; 
  $("message").textContent = "‚èπ Game paused."; 
  active = false; 
};
$("helpTab").onclick = () => {
  alert("üéØ How to Play:\n‚Ä¢ Click Restart to begin.\n‚Ä¢ Choose the correct probability answer.\n‚Ä¢ Use hints if needed.\n‚Ä¢ 15 rounds total.\n‚Ä¢ Covers Stage 5 concepts: compound events, Venn diagrams, conditional probability, and independent/dependent events.");
};
})();
</script>
</body>
</html>

